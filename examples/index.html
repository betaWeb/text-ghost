<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<title>Text Ghost</title>
	<link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
	<link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
	<link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">
</head>
<body>
	<div id="autocomplete"></div>
	<div class="container">
		<div class="columns">
			<div class="column col-4 col-mx-auto">
				<div class="form-group">
					<label class="form-label" for="input-search">Search</label>
					<input class="form-input" type="text" name="search" id="input-search" placeholder="Your search here...">
				</div>
			</div>
		</div>
	</div>

	<script type="text/javascript" src="../dist/text-ghost.min.js"></script>
	<script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {

            let results = []
            const text_ghost = new TextGhost(
                'input[name="search"]',
                null, // ['JavaScript', 'PHP', 'Python', 'MySQL', 'NodeJS'],
                {
                    search_policy: TextGhost.policies.STARTS_WITH,
                    case_sensitive: true,
                    beforePredicate(value) {
                        return fetch(`https://geocoder.tilehosting.com/fr/q/${value}.js?key=Of2UNAvCI29lUlqrAE6V`)
                            .then(response => response.json())
                            .then(response => {
                                response.results.forEach(({name}) => (name.length > 2 && !text_ghost.list.includes(name)) && (text_ghost.list.push(name) && text_ghost.list.push(name.toLowerCase())))
								results = response.results
							})
                    },
					onPredicate(predicate) {
                        const infos = results.filter(item => item.name.toLowerCase() === predicate.toLowerCase())
                        console.log(infos[0])
					}
                }
            )

        })
	</script>
</body>
</html>